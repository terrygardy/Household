@using GARTE.TypeHandling;
@using Household.Localisation.Common;
@using Household.Localisation.Main.MasterData;

@model Household.Models.Finance.CPurchaseModel

@{
	string m_strBaseAction = Url.Action("", "Purchases");
}

<div class="w100">
	<div class="col-xs-12 col-sm-6">
		@Html.LabelFor(m => m.Purchase.Occurrence)<span> @GeneralText.DateFormat</span>
		<input type="text" id="tbxDate" data-bind="value: Occurrence" required />
	</div>
	<div class="col-xs-12 col-sm-6">
		@Html.LabelFor(m => m.Purchase.Amount)<span> (€)</span>
		<input type="text" id="tbxAmount" data-bind="value: Amount" required />
	</div>
	<div class="col-xs-12 col-sm-6">
		<span>@ShopText.Shop</span>
		<select id="cboShop" data-bind="value: Shop_ID" required>
			@Html.DisplayFor(m => m.Shops, "SelectOptions")
		</select>
	</div>
	<div class="col-xs-12 col-sm-6">
		<span>@BankAccountText.BankAccount</span>
		<select id="cboBankAccount" data-bind="value: Payer_ID" required>
			@Html.DisplayFor(m => m.BankAccounts, "SelectOptions")
		</select>
	</div>
	<div class="col-xs-12">
		@Html.LabelFor(m => m.Purchase.Description)
		<textarea id="tbxDescription" data-bind="value: Description" />
	</div>
</div>

@Scripts.Render("~/bundles/Purchase")
<script type="text/javascript">
	(function () {
		Purchase.Fill('@m_strBaseAction', @Model.Purchase.ID, '@Base.convertShortDateString(Model.Purchase.Occurrence)', @Base.convertLong(Model.Purchase.Shop_ID).ToString(),
						@Base.convertLong(Model.Purchase.Payer_ID).ToString(), '@Model.Purchase.Amount.ToString("N2")', '@Html.Raw(HttpUtility.JavaScriptStringEncode(Model.Purchase.Description))');
		MasterData.start();
		Purchase.start();
	})();
</script>